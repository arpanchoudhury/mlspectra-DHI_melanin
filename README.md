# mlspectra-DHI_melanin

Designing of virtual chemical space of DHI melanin and machine learning (ML) prediction of their entire UV-visible spectra and thermodynamic stability. 
The step-wise procedure is described below.

## 1. Structure generation using combinatorial algorithm
```
python generator_dimer.py
python generator_trimer.py
python generator_tetramer.py
```
The codes need to be run in the above order. This will generate all possible unique dimers, trimers and tetramers structures from the monomers. 

## 2. ML training data 
In this study, we considered only the tetramers for ML modeling. A subset of generated tetramers are first relaxed with the UFF force field and then optimized using the B3LYP/6-31G(d) level. The final optimized geometries are contained in ``` ML/optimized_geometry/```. Their TD-CAM-B3LYP/6-31G(d) electronic spectra of the lowest 70 singlet excitation energies and the corresponding oscillator strengths are contained in ``` ML/spectra/```.
### ML input data
We used three types of input descriptors: (a) fingerprint (stored in ```fingerprint_descriptor.dat```), (b) Coulomb matrix and (c) SLATM which can be generated by running the below commands
```
python coulomb_matrix_generator.py
python SLATM_generator.py
```
### ML output data
We tested several kinds of spectral data for training our multi-output KRR-ML model: <br />
Excitation energies (```lowest70states_excitationEnergy.dat```), <br />
Oscillator strengths (```lowest70states_oscillatorStrength.dat```), <br />
Bin intensities of different bin resolutions: 100 nm (```100nmResolution_spectra.dat```), 50 nm (```50nmResolution_spectra.dat```), 25 nm (```25nmResolution_spectra.dat```). <br />
Spectra of any desired bin resolution can be generated by changing ```resolution``` in ```ML/binnining.py```
<br />
<br />
We also trained single-output KRR-ML for the thermodynamic stability (```relativeStability-kcal_b3lyp.dat```) of the tetramer molecules

## 3. ML training
Final ML training and predictions can be done by running the following command, 
```
python ML/inp.py 
```

## Requirements
The codes were tested with Python 3.8.10 on HP-OMEN [Intel(R) Core(TM) i5-10300H CPU @ 2.50GHz] as well as with Python 2.7.5 on linux workstation [Intel(R) Xeon(R) CPU E5-1650 v4 @ 3.60GHz]. Below are the versions of python modules used on the HP-OMEN
```
numpy 1.22.3
pandas 1.4.2
scipy 1.8.0
scikit-learn 1.0.2
qml 0.2.1
```
